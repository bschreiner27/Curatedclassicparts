{
  email admin@roadandraceparts.com
  # For first runs while testing, you can enable Letâ€™s Encrypt staging to avoid rate limits:
  # acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}

roadandraceparts.com, www.roadandraceparts.com {
  @api path /api/*
  handle @api {
    reverse_proxy api:3000
  }

  @webhooks path /webhooks/*
  handle @webhooks {
    reverse_proxy api:3000
  }

  handle {
    reverse_proxy web:80
  }

  encode zstd gzip
  header {
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    Referrer-Policy "no-referrer-when-downgrade"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    Permissions-Policy "camera=(), microphone=(), geolocation=()"
  }

  log {
    output stdout
    format console
  }
}
